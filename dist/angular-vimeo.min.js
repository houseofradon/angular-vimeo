/*!
 * angular-vimeo-player
 * Philip Knape <philip.knape@gmail.com>
 * 
 * License: MIT
 */
!function(e,t){"use strict";t.module("ngVimeo",["ngSanitize"]).config(["$sceDelegateProvider",function(e){e.resourceUrlWhitelist(["self","http://player.vimeo.com/video/*"])}]).constant("ngVimeoConfig",{method:{},event:{}}).constant("playerBaseURI","https://player.vimeo.com/video/").constant("originExpression",/^https?:\/\/player.vimeo.com/).directive("vimeo",["ngVimeoConfig","$window","$timeout","$compile",function(e,n,i,o){var r=["loadProgress","playProgress","play","pause","finish","seek"],a=["play","pause","paused","seekTo","unload","getCurrentTime","getDuration","getVideoEmbedCode","getVideoHeight","getVideoWidth","getVideoUrl","getColor","setColor","setLoop","getVolume","setVolume","addEventListener"],s=["autopause","autoplay","badge","byline","color","loop","portrait","title"],d={position:"relative","padding-bottom":"56.25%",height:0},l={position:"absolute",top:0,left:0,width:"100%",height:"100%"};return{restrict:"EA",replace:!0,template:"<div></div>",scope:{settings:"=",iframeId:"@",videoId:"@",width:"@",height:"@",haltinit:"@",responsive:"@",playerId:"@"},link:function(u,c,p){function v(){j=t.extend(t.copy(e),{responsive:u.responsive||!0,videoId:u.videoId,iframeId:u.iframeId||"vimeoPlayer",haltInit:u.haltinit,width:u.width,height:u.height,playerId:u.playerId||"angular-vimeo"},u.settings)}function f(e,t,n){if(!t)return"";var i=Object.keys(e).map(function(n){var i="string"==typeof t&&"padding-bottom"===n?t:e[n];return n+":"+i+";"}).join(" ");return' style="'+i+'" '}function m(e,t,n,i){var o=i?'"':"";return e.filter(function(e){return t[e]}).map(function(e){return e+"="+o+t[e]+o}).join(n)}function g(e,t){var n='src="https://player.vimeo.com/video/'+e.videoId,i=m(t,e,"&",!1);return n+"?"+i+(i?"&":"")+"api=1&player_id="+e.playerId+'" '}function h(e,t,n){var i=g(e,s),o=["id","width","height","frameborder"],r=m(o,e," ",!0);return"<div "+n+"><iframe "+t+i+r+"></iframe></div>"}function y(){w(),b(!0)}function I(){w(),b()}function w(){$&&(V(r,"removeEventListener"),n.removeEventListener("message",C,!1),L.removeChild($[0]),t.element(c).css("display","none"),k(),$=null)}function b(e){if(v(),j.method.setup=y,!j.haltInit||e){if(!j.videoId)return void console.warn("you need to supply a vimeo src");if(j.method.destroy=w,t.element(c).css("display","block"),i(function(){c.html(h(j,f(l,j.responsive,!0),f(d,j.responsive,!1))),$=o(c.contents())(u)},0),"function"==typeof j.event.resize){var r=!1;r!==!1&&i.cancel(r),r=i(function(){return n.on("resize",j.event.resize,200)})}k(j.method),n.addEventListener("message",C,!1)}}function C(e){if(!/^https?:\/\/player.vimeo.com/.test(e.origin))return!1;"*"===z&&(z=e.origin);var t=JSON.parse(e.data);return"ready"===t.event&&V(r,"addEventListener"),"function"==typeof j.event[t.event]&&t.player_id===j.playerId?j.event[t.event].apply(null,Object.keys(t).map(function(e){return t[e]})):void 0}function E(e,t){var n={method:e};t&&(n.value=t);var i=JSON.stringify(n);$.find("iframe")[0].contentWindow.postMessage(i,z)}function V(e,n){t.forEach(e,function(e,t){E(n,e)})}function k(e){u.internalControl=e||{},e&&a.forEach(function(e){u.internalControl[e]=function(){if(u.internalControl[e]){var t;t=Array.prototype.slice.call(arguments),t.unshift(e),E.apply(null,t)}}})}var L=t.element(c)[0];t.element(c).css("display","none");var $,j,z="*";c.one("$destroy",function(){return w()}),u.$watch("settings",function(e){return null!==e&&void 0!==e?I():void 0},!0)}}}])}(window,window.angular);